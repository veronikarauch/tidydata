m <- mean(mtcars$wt)
predict(fit2, newdata = m, interval = ("confidence"))
fit2
predict(fit2, newdata = c(1,m),  interval = ("confidence"))
predict(fit2, newdata = m,  interval = ("confidence"), data=mtcars)
predict(fit2, newdata = mean(mtcars$wt),  interval = ("confidence"), data=mtcars)
predict(lm(mpg~wt, data=mtcars), newdata = mean(mtcars$wt),  interval = ("confidence"), data=mtcars)
fit2<- lm(mpg~wt, data=mtcars)
summary(fit2)
?mtcars
predict(lm(mpg~wt, data=mtcars),  interval = ("confidence"), data=mtcars)
fit2<- lm(mpg~wt, data=mtcars)
predict(fit2,  interval = ("confidence"), data=mtcars)
predict(fit2,  interval = ("confidence"))
x<-mtcars$wt
y<-mtcars$mpg
fit<-lm(y ~ x)
predict(fit,data.frame(x=mean(x)), interval="confidence")
fit2<- lm(mpg~wt, data=mtcars)
predict(fit2,data.frame(x=mean(mtcars$wt)), interval = ("confidence"))
x<-mtcars$wt
y<-mtcars$mpg
predict(fit,data.frame(x=mean(mtcars$wt)), interval = ("confidence"))
m <- mean(mtcars$wt)
predict(fit,m, interval="confidence")
predict(fit,newdata=m, interval="confidence")
predict(fit,data.frame(x=mean(mtcars$wt)), interval = ("confidence"))
predict(fit,x=m, interval="confidence")
m <- mean(mtcars$wt)
m
predict(fit,data.frame(x=3), interval = ("prediction"))
predict(fit,data.frame(x=2), interval = ("confidence"))
fit<-lm(y ~ I(x/2))
fit
summary(fit)$coefficients
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
fit(y~x)
fit <- lm(y~x)
summary(fit)
sumCoef <- summary(fit)$coefficients
x<-mtcars$wt
y<-mtcars$mpg
fit2<- lm(y~x)
predict(fit2,data.frame(x=mean(mtcars$wt)), interval = ("confidence"))
predict(fit2,data.frame(x=3), interval = ("prediction"))
fit3<-lm(y ~ I(x/2))
predict(fit3, interval="confidence")
summary(fit3)
coef<-summar(fit3)$coef
coef<-summary(fit3)$coef
coef
fit3$df
coef[2,1]+(-1,1)*qt(0.975, df = fit3$df)*coef[2,2]
coef[2,1] + (-1,1)*qt(0.975, df = fit3$df)*coef[2,2]
coef[2,1] + c(-1,1)*qt(0.975, df = fit3$df)*coef[2,2]
coef<-summary(fit3)$coef
coef
summary(fit2)
fits4<-lm(y~1)
summary(fit4)
summary(fits4)
summar(fit2)
summary(fit2)
6.027/3.046
fit2$residuals
sum(fit2$residuals^2)
sum(fit4$residuals^2)
sum(fit4s$residuals^2)
sum(fits4$residuals^2)
sum(fit2$residuals^2)/sum(fits4$residuals^2)
predict(fit2,data.frame(x=mtcars$wt))
sum((mtcars$mpg - predict(fit2,data.frame(x=mtcars$wt))^2)
)
d<-mtcars$mpg - predict(fit2,data.frame(x=mtcars$wt))
d
d^2
sum(d^2)
sum(fit2$residuals^2)
data(mtcars)
head(mtcars)
?mtcars
?inference.measures
?influence.measures
?dfbeta
head(mtcars)
?mtcars
library(ggplot2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()
plot(mtcars$wt,mtcars$mpg)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()
g
g + geom_point()
?mtcars
g<-ggplot(mtcars, aes(x = cyl, y= mpg, color=am))
g + geom_point()+lm
g + geom_point()
g<-ggplot(mtcars, aes(x = hp, y= mpg, color=am))
g + geom_point()
dim(mtcars)
summary(mtcars)
library(dplyr)
cars.am <- mtcars %>%
group_by(am)
summerise(average= mean(mpg))
cars.am <- mtcars %>%
group_by(am)
summarise(average= mean(mpg))
cars.am <- mtcars %>%
group_by(am) %>%
summarise(average= mean(mpg))
cars.am
length(mtcars$am)
is.na(mtcars.am)
is.na(mtcars$am)
is.na(mtcars)
sapply(sum,is.na(mtcars))
sapply(is.na(mtcars), sum)
?col.means
head(mtcar)
head(mtcars)
sapply(is.na(mtcars), Col.sums)
sapply(is.na(mtcars), ColSums)
colSums(is.na(mtcars))
sapply(is.na(mtcars), colSums)
sapply(is.na(mtcars), colSums)
dim(is.na(mtcars))
x<-is.na(mtcars)
sapply(x, colSums)
?sapply
x <- list(a = 1:10, beta = exp(-3:3), logic = c(TRUE,FALSE,FALSE,TRUE))
x
class(mtcars)
x<-as.array(mtcars)
x<-as.list(mtcars)
sapply(x, colSums)
sapply(x, sum)
sapply(is.na(x), sum)
?mtcars
cars.am <- mtcars %>%
group_by(am) %>%
summarise(average= mean(mpg))
cars.am
plot(mtcars$wt, mtcars$am)
plot(mtcars$mpg, mtcars$am)
g<-ggplot(mtcars, aes(x = hp, y= mpg, color=am))
g + geom_point()
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()
y <- mtcars$mpg
x1 <- mtcars$am
fit <- lm(y~x1)
summary(fit)
cars.am
x2 <- mtcars$wt
fit <- lm(y~x1+x2)
summary(fit)
x2 <- mtcars$wt
fit2 <- lm(y~x1+x2)
summary(fit2)
37.32155-0.02362
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()+geom_smooth()
g + geom_point()+stat_smooth(formula=y~x1+x2)
Vif(fit2)
?VIf
?Vif
library(car)
fit3 <- lm(y~x1:x2)
summary(fit3)
fit3 <- lm(y~x1*x2)
summary(fit3)
?anova
anova(fit,fit2,fit3)
anova(fit,fit2)
plot(fit)
plot(fit2)
plot(fit3)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()*geom_smooth(fit)
g + geom_point()*geom_smooth(lm(y~x1))
g + geom_point()+geom_smooth(lm(y~x1))
plot(resid(lm(y~x2)),resid(lm(x1~x2)))
plot(resid(lm(y~x1)),resid(lm(x2~x1)))
summary(fit3)
fit3 <- lm(y~x1*x2-1)
summary(fit3)
fit2 <- lm(y~x1+x2-1)
summary(fit2)
fit3 <- lm(y~x1*x2)
summary(fit3)
31.4161+ 14.8784
-3.7859-5.2984
coef(fit3)
g1 = g
g1 <-g1 + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3])
g1 <-g1 + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit)[3]+coef(fit3)[4])
g1
g1 <-g1 + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3])
g1 <-g1 + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g1
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()
g1 = g
g1 <-g1 + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3])
g1 <-g1 + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g1
g1 = g
g1 <-g1 + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3])
g1
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
fit <- lm(y~factor(x1))
summary(fit)
fit3 <- lm(y~factor(x1)*x2)
summary(fit3)
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
?dfbeta
dfbeta(fit3)
g1
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
fit2 <- lm(y~x1+x2-1)
fit2 <- lm(y~x1+x2)
summary(fit2)
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit2)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit2)[1]+coef(fit2)[2], slope=coef(fit2)[3])
fit3
?mtcars
x3 <- mtcars$hp
fit3 <- lm(y~factor(x1)*x2+x3)
summary(fit3)
fit3 <- lm(y~factor(x1)*x2)
summary(fit3)
fit3 <- lm(y~x2*factor(x1))
summary(fit3)
x3 <- mtcars$hp
fit4 <- lm(y~factor(x1)*x2+x3)
summary(fit4)
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
```
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
fit3 <- lm(y~factor(x1)*x2)
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
?mtcars
a <- mtcars$mpg
b <- mtcars$cyl
c <- mtcars$wt
fat <- lm(a~factor(b)*c)
fat
b
fat <- lm(a~factor(b)+c)
fat
fit <- lm(a~factor(b))
fit
fut <- lm(a~factor(b)*c)
summary(fut)
summary(fat)
summary(fit3)
fet <- lm(a ~ I(c * 0.5) + factor(b))
fet
fat
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
ot <- lm(y~x)
hr<-hatvalues(ot)
hr
dfbeta(ot)
anova(fat, fut)
dfbetas(fit)
fit <- lm(a~factor(b))
dfbetas(fit)
ot <- lm(y~x)
dfbeta(ot)
hr<-hatvalues(ot)
hr
dfbetas(ot)
?dfbetas
install.packages(car)
install.packages(CAR)
install.packages("car")
library(car)
Vif(fit2)
?vif
vif(fit2)
x2 <- mtcars$wt
fit2 <- lm(y~x1+x2)
y <- mtcars$mpg
x1 <- mtcars$am
fit <- lm(y~factor(x1))
x2 <- mtcars$wt
fit2 <- lm(y~x1+x2)
fit3 <- lm(y~factor(x1)*x2)
anova(fit,fit2,fit3)
pairs(mpg ~ ., data = mtcars)
pairs(mpg ~ ., data = mtcars)
initialmodel <- lm(mpg ~ ., data = mtcars)
bestmodel <- step(initialmodel, direction = "both")
?qsec
?step
x3 <- mtcars$qsec
fit4 <- lm(y~factor(x1)*x2+x3)
summary(fit4)
x3 <- mtcars$qsec
fit4 <- lm(y~factor(x1)+x2+x3)
summary(fit4)
vif(fit3)
all <- lm(mpg ~ ., data = mtcars)
best <- step(all, direction = "both")
all <- lm(mpg ~ ., data = mtcars)
summary(all)
plot(all)
x3 <- mtcars$qsec
fit4 <- lm(y~factor(x1)+x2+x3)
summary(fit4)
plot(fit4)
dfbetas(fit4)
summary(fit4)
summary(fit3)
summary(fit4)
all <- lm(mpg ~ ., data = mtcars)
best <- step(all, direction = "both")
anova(fit, fit4)
summary(fit4)
anova(fit, fit2, fit3, fit4)
anova(fit, fit2, fit4)
par(mfrow=c(2, 2))
plot(fit4)
dfbetas(fit4)
1.093842e+00
-2.543348e-01
max(dfbetas)
max(dfbetas(fit4))
?mtcars
summary(fit4)
summary(fit)
coef(fit)
summary(fit)[1,1]
summary(fit)%coef
summary(fit)$coef
summary(fit3)$coef
plot(resid(lm(y~x2+x1:x2),resid(lm(x1~x2+x1:x2)))
plot(resid(lm(y~x2+x1:x2),resid(lm(x1~x2+x1:x2))))
plot(resid(lm(y~x2+x1:x2)),resid(lm(x1~x2+x1:x2)))
font_adjustmen: -1
par(mfrow=c(2, 2))
library(ggplot2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=am))
g + geom_point()
```{r,echo=TRUE, fig.height=4,fig.width=5}
install.packages("gridExtra")
library(girdExtra)
library(gridExtra)
require(gridExtra)
require(gridExtra)
library(ggplot2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point()
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
grid.arrange(g, g1, ncol=2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point()
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
grid.arrange(g, g1, ncol=2)
grid.arrange(g, g1, ncol=2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point()
grid.arrange(g, g1, ncol=2)
grid.arrange(g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point(), g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4]), ncol=2)
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point()
grid.arrange(
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point(),
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4]),
ncol=2)
grid.arrange(
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point(),
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g1 + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4]),ncol=2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))
g + geom_point()
g
g1
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))+ geom_point()
g
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am))) + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])
g1
grid.arrange(g, g1 ,ncol=2)
require(gridExtra)
library(ggplot2)
g<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am)))+ geom_point()+ggtitle("Plot 1")
g1<-ggplot(mtcars, aes(x = wt, y= mpg, color=factor(am))) + geom_point() + geom_abline(intercept=coef(fit3)[1], slope=coef(fit3)[3]) + geom_abline(intercept=coef(fit3)[1]+coef(fit3)[2], slope=coef(fit3)[3]+coef(fit3)[4])+ggtitle("Plot 3")
grid.arrange(g, g1 ,ncol=2)
dfbetas(fit4)[13:20,]
library(MASS)
schuttle
shuttle
data(InsectSprays)
?glm
jead(shuttle)
head(shuttle)
names(shuttle)
?merge
replace?
?replace
y<-replace(shuttle$use, auto, 1)
?glm
f<-glm()
y<-shuttle$use
x<-shuttle$wind
f<-glm(y~x, family=binomial)
f
summary(f)
InsectSpray
InsectSprays
v<-InsectSprays$count
w<-InsectSprays$spray
d<-glm(v~w, family=poisson)
d
d<-glm(v~w, family=poisson)
y<-shuttle$use
x<-shuttle$wind
f<-glm(y~x, family=binomial)
f<-glm(y~x, family=binomial)
f
f<-glm(1-y~x, family=binomial)
f<-glm(I(1-y)~x, family=binomial)
f<-glm(y~x, family=binomial, offset=z)
z<-shuttle$magn
f<-glm(y~x, family=binomial, offset=z)
z
y<-shuttle$use
x<-shuttle$wind
f<-glm(y~x, family=binomial)
odd<-exp(f$coef)
odd
odd[1]/odd[2]
f<-glm(y~x-1, family=binomial)
odd<-exp(f$coef)
odd[1]/odd[2]
y<-as.numeric(shuttle$use)
x<-as.factor(shuttle$wind)
f<-glm(y~x-1, family=binomial)
y<-shuttle$use
x<-shuttle$wind
z<-shuttle$magn
f<-glm(y~as.factor(x)-1, family=binomial)
odd<-exp(f$coef)
odd[1]/odd[2]
shuttle$newUse <- as.numeric(shuttle$use == "auto")
shuttle
f<-glm(newUse~as.factor(x)-1, family=binomial)
f<-glm(newUse~as.factor(wind)-1,data=shuttle, family=binomial)
odd<-exp(f$coef)
odd[1]/odd[2]
f<-glm(newUse~as.factor(wind)+factor(magn)-1,data=shuttle, family=binomial)
odd<-exp(f$coef)
odd[1]/odd[2]
d<-glm(I(1-newUse)~as.factor(wind),data=shuttle, family=binomial)
f<-glm(newUse~as.factor(wind)-1,data=shuttle, family=binomial)
f
d<-glm(I(1-newUse)~as.factor(wind)-1,data=shuttle, family=binomial)
d
glm(v~w-1, familypoisson)
glm(v~w-1, family=poisson)
glm(v~w, family=poisson)
x <- -5 : 5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54,
3.87, 4.97)
knotPoint <- c(0)
spline <- sapply(knotPoint, function(knot) (x > knot) * (x - knot))
xMatrix <- cbind(1, x, spline)
fit <- lm(y ~ xMatrix - 1)
yhat <- predict(fit)
yhat
slope <- fit$coef[2] + fit$coef[3]
slope # 1.013
plot(x, y)
lines(x, yhat, col=2)
splin
spline
library(shiny)
setwd(~/Desktop/shiny)
setwd("~/Desktop/shiny")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
